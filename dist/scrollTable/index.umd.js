(function(u,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(u=typeof globalThis<"u"?globalThis:u||self,e(u.index=u.index||{},u.Vue))})(this,function(u,e){"use strict";function E(l){return{handleToggle:r=>{l.emit("handleToggle",r)}}}const T=l=>Array.isArray(l)&&l||[],b=(l,t=new WeakMap)=>{if(l===null)return l;if(l instanceof Date)return new Date(l);if(l instanceof RegExp)return new RegExp(l);if(typeof l!="object")return l;if(t.get(l))return t.get(l);let r=new l.constructor;t.set(l,r);for(let o in l)l.hasOwnProperty(o)&&(r[o]=b(l[o],t));return r};function z(l,t,r){const{handleToggle:o}=E(r),w=n=>{let i=T(n);return b(i)},C=e.computed(()=>{if(t.mode==="page")return l.pageData[l.currPage-1]||[];if(t.mode==="single")return l.currData||[]}),S=()=>{if(t.mode==="page")if(l.tableData.length){let n=[],i=Math.ceil(l.tableData.length/t.pageSize);for(let f=1;f<=i;f++){let d=l.tableData.slice(f*t.pageSize-t.pageSize,f*t.pageSize);n.push(d)}l.pageData=n,n[l.currPage-1]||(l.currPage=1,l.toggleCount+=1,l.toggleCount>=t.emitCondition&&o(t.name))}else l.pageData=[[]],l.currPage=1,l.toggleCount=0,o(t.name)},c=()=>{l.intervalId===null&&!l.isStopToggle&&t.mode==="page"&&(l.intervalId=setInterval(()=>{l.pageData[l.currPage]?l.currPage+=1:(l.currPage=1,l.toggleCount+=1,l.toggleCount>=t.emitCondition&&o(t.name))},t.toggleDur))},y=(n=1)=>{P(),l.currPage=n,c()},g=async(n,i=1,f=[])=>{console.log("shiftLen",i),console.log("arr",n),n.push(...f),await new Promise(d=>setTimeout(d,300));for(let d=0;d<i;d++)n[d]={};n.splice(0,i)},h=async()=>{if(t.mode==="single")if(l.tableData.length){const n=Math.ceil((l.tableData.length-t.pageSize)/t.togglePage)+1;if(n===1&&(console.log("1"),l.currPage=1,l.toggleCount+=1,g(l.currData,t.pageSize,l.tableData.slice()),l.toggleCount>=t.emitCondition&&o(t.name)),n!==1&&l.currPage<=n&&(console.log("2"),l.currPage===1?(console.log("2-1"),l.currData=l.tableData.slice(0,t.pageSize)):(console.log("2-2"),console.log("start",t.pageSize-1+(l.currPage-2)*t.togglePage+1),console.log("end",t.pageSize-1+(l.currPage-1)*t.togglePage+1),g(l.currData,t.togglePage,l.tableData.slice(t.pageSize-1+(l.currPage-2)*t.togglePage+1,t.pageSize-1+(l.currPage-1)*t.togglePage+1)))),l.currPage>n){console.log("3"),l.currPage=1,l.toggleCount+=1,l.toggleCount>=t.emitCondition&&o(t.name),h();return}}else l.rowsHeight=[],l.currData=[],l.currPage=1,l.toggleCount=0,o(t.name)},k=()=>{l.intervalId===null&&!l.isStopToggle&&t.mode==="single"&&(l.intervalId=setInterval(()=>{l.currPage+=1,h()},t.toggleDur))},P=()=>{l.intervalId&&(clearInterval(l.intervalId),l.intervalId=null)};return{deepCloneArr:w,getCurrData:C,setPageData:S,setPageTimer:c,setPage:y,setCurrData:h,setToggleTimer:k,clearTimer:P,setIndex:n=>{n.map((i,f)=>i._index_=f+1)}}}function x(l,t){const r=e.computed(()=>function(c,y){const g=["f-scroll-table_row"];return t.stripe&&y%2===1&&g.push("f-scroll-table_row--striped"),t.wrap&&g.push("f-scroll-table_row--nowrap"),g}),o=e.computed(()=>{const c=["cell"];return t.wrap||c.push("cell--nowrap"),c}),w=e.computed(()=>({})),C=e.computed(()=>function(c){return{"max-height":l.rowsHeight[c]||"auto"}}),S=e.computed(()=>function(c,y,g,h){return typeof t.cellStyle=="function"?t.cellStyle.call(null,{rowIndex:g,columnIndex:h,row:c,column:y}):t.cellStyle||{}});return{getRowClass:r,getCellClass:o,getBodyStyle:w,getRowStyle:C,getCellStyle:S}}const I={class:"f-scroll-table_header-wrapper"},V={class:"f-scroll-table_header",cellspacing:"0",cellpadding:"0",border:"0"},N=["width"],A={class:"cell"},F={class:"f-scroll-table_body",cellspacing:"0",cellpadding:"0",border:"0"},R=["width"],D=e.defineComponent({name:"index",props:{name:{default:""},data:{default:()=>[]},columns:{default:()=>[]},border:{type:Boolean,default:!0},stripe:{type:Boolean,default:!0},wrap:{type:Boolean,default:!0},maxHeight:{default:"auto"},cellStyle:null,mode:{default:"single"},pageSize:{default:5},togglePage:{default:1},toggleDur:{default:5*1e3},emitCondition:{default:2}},setup(l,{expose:t}){const r=l,o=e.reactive({tableData:[],currData:[],pageData:[],currPage:1,toggleCount:0,intervalId:null,isStopToggle:!1,isAnimate:!1,rowsHeight:[]}),w=e.getCurrentInstance(),{deepCloneArr:C,getCurrData:S,setPageData:c,setPageTimer:y,setCurrData:g,setToggleTimer:h,setPage:k,setIndex:P}=z(o,r,w),{getRowClass:_,getCellClass:n,getBodyStyle:i,getRowStyle:f,getCellStyle:d}=x(o,r);return e.watch(()=>r.data,p=>{o.tableData=C(p),P(o.tableData),c(),y(),g(),h()}),t({setPage:k}),(p,H)=>(e.openBlock(),e.createElementBlock("div",{ref:"scrollTable",class:e.normalizeClass(["f-scroll-table",{"f-scroll-table--border":r.border}])},[e.createElementVNode("div",I,[e.createElementVNode("table",V,[e.createElementVNode("colgroup",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.columns,(a,s)=>(e.openBlock(),e.createElementBlock("col",{width:a.width,key:s},null,8,N))),128))]),e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.columns,(a,s)=>(e.openBlock(),e.createElementBlock("td",{class:"f-scroll-table_cell",style:e.normalizeStyle({"max-width":a.width}),key:s},[e.createElementVNode("div",A,e.toDisplayString(a.label),1)],4))),128))])])])]),e.createElementVNode("div",{class:"f-scroll-table_body-wrapper is-hidden-scrollbar",ref:"bodyWrapper",style:e.normalizeStyle(e.unref(i))},[e.createElementVNode("table",F,[e.createElementVNode("colgroup",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.columns,(a,s)=>(e.openBlock(),e.createElementBlock("col",{width:a.width,key:s},null,8,R))),128))]),e.createVNode(e.TransitionGroup,{tag:"tbody",name:"fade",class:"f-scroll-table_body-inner"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(S),(a,s)=>(e.openBlock(),e.createElementBlock("tr",{class:e.normalizeClass(e.unref(_)(a,s)),key:a},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.columns,(m,B)=>(e.openBlock(),e.createElementBlock("td",{class:"f-scroll-table_cell is-hidden-scrollbar",style:e.normalizeStyle({width:m.width,"max-width":m.width}),key:B},[m.slot?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(e.unref(n))},[e.renderSlot(p.$slots,m.slot,{params:{row:a,column:m.prop,$index:s}})],2)):m.type=="index"?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(e.unref(n)),style:e.normalizeStyle(e.unref(d)(a,m.prop,s,B))},e.toDisplayString(a._index_),7)):(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(e.unref(n)),style:e.normalizeStyle(e.unref(d)(a,m.prop,s,B))},e.toDisplayString(a[m.prop]),7))],4))),128))],2))),128))]),_:3})])],4)],2))}});D.install=function(l){l.component("FScrollTable",D)};const M={title:"scrollTable 滚动表格",category:"数据展示",status:"20%",install(l){l.use(D)}};u.ScrollTable=D,u.default=M,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
