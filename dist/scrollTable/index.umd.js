(function(S,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(S=typeof globalThis<"u"?globalThis:S||self,e(S.index=S.index||{},S.Vue))})(this,function(S,e){"use strict";function D(t){return{handleToggle:r=>{t.emit("handle-toggle",r)},handleCellClick:(r,_,s,d,m)=>{t.emit("cell-click",_,s,d,m,r)}}}const b=t=>Array.isArray(t)&&t||[],P=(t,l=new WeakMap)=>{if(t===null)return t;if(t instanceof Date)return new Date(t);if(t instanceof RegExp)return new RegExp(t);if(typeof t!="object")return t;if(l.get(t))return l.get(t);let i=new t.constructor;l.set(t,i);for(let r in t)t.hasOwnProperty(r)&&(i[r]=P(t[r],l));return i};function $(t,l,i){const{handleToggle:r}=D(i),_=a=>{let n=b(a);return P(n)},s=()=>{t.toggleCount+=1,t.toggleCount>=l.emitCondition&&r(l.name)},d=async(a,n,g)=>{let y=g;n.map(w=>w._index_=++y),t.currData.length?a===l.pageSize?t.currData=[...n]:(t.currData.push(...n),t.currData.splice(0,a)):t.currData.push(...n)},m=async()=>{if(t.tableData.length){c(!1,!0),t.isEmpty=!1;let a;l.mode==="single"?a=l.togglePage:a=l.pageSize;let n,g;t.currPage===1?(n=0,g=l.pageSize):(n=a*(t.currPage-2)+l.pageSize,g=a*(t.currPage-1)+l.pageSize);let y=t.tableData.slice(n,g);y.length?t.currPage===1&&t.toggleCount===0?d(l.pageSize,y,n):t.currPage===1?await d(l.pageSize,y,n):await d(a,y,n):(t.currPage=1,s(),m()),x()}else c(),t.currPage=1,t.currData=[],t.isEmpty=!0,o()},x=()=>{t.intervalId===null&&!t.isStopToggle&&(t.intervalId=setInterval(()=>{t.currPage+=1,m()},l.toggleDur))},o=()=>{t.setTimeoutId===null&&(t.setTimeoutId=setTimeout(()=>{r(l.name)},l.emptyEmitDur))},c=(a=!0,n=!0)=>{t.intervalId&&a&&(clearInterval(t.intervalId),t.intervalId=null),t.setTimeoutId&&n&&(clearTimeout(t.setTimeoutId),t.setTimeoutId=null)};return{deepCloneArr:_,setCurrData:m,setPageInterval:x,setEmptyTimeout:o,clearTimer:c,setPage:(a=1)=>{c(),t.currPage=a;let n;l.mode==="single"?n=l.togglePage:n=l.pageSize;let g=n*(t.currPage-1),y=n*(t.currPage-1)+l.pageSize,w=t.tableData.slice(g,y);w.length?(d(l.pageSize,w,g),x()):m(),t.tableData.length||o()}}}function I(t,l){const i=e.computed(()=>function(o,c){const p=["f-scroll-table__row"];return l.stripe&&c%2===1&&p.push("f-scroll-table_row--striped"),p}),r=e.computed(()=>{const o=["cell"];return l.wrap?o.push("cell--wrap"):o.push("cell--nowrap"),o}),_=e.computed(()=>function(o){let c=o.reduce((p,a)=>p+=a.width,0);return{width:`${c}px`,"max-width":`${c}px`}}),s=e.computed(()=>({height:l.maxHeight||"auto","max-height":l.maxHeight||"auto","--page-animate-dur":`${l.pageAnimateDur}ms`})),d=e.computed(()=>function(o){return{}}),m=e.computed(()=>function(o){return{width:`${o.width}px`,"max-width":`${o.width}px`,"text-align":o.align||l.align||"start"}}),x=e.computed(()=>function(o,c,p,a){return typeof l.cellStyle=="function"?l.cellStyle.call(null,{rowIndex:p,columnIndex:a,row:o,column:c}):l.cellStyle||{}});return{getRowClass:i,getCellClass:r,getTableStyle:_,getBodyStyle:s,getRowStyle:d,getExtraCellStyle:m,getCellStyle:x}}const E=e.defineComponent({__name:"index",props:{type:{default:"default"},direction:{default:"up"},speed:{default:60},mode:{default:"infinite"}},setup(t){const l=t,i=e.ref(),r=e.ref(),_=e.computed(()=>{var a,n,g,y;let s=((a=i.value)==null?void 0:a.offsetWidth)||0,d=((n=i.value)==null?void 0:n.offsetHeight)||0,m=((g=r.value)==null?void 0:g.offsetWidth)||0,x=((y=r.value)==null?void 0:y.offsetHeight)||0;if(l.mode==="overflow"&&(["up","down"].includes(l.direction)&&x<d||["left","right"].includes(l.direction)&&m<s))return{"--text-scroll-width":`${s}px`,"--text-scroll-height":`${d}px`,animation:""};let o,c,p;return["up","down"].includes(l.direction)&&(o=d+x,c=o/l.speed||0,p=`up-scroll linear ${c}s infinite ${l.direction==="down"?"reverse":""}`),["left","right"].includes(l.direction)&&(o=s+m,c=o/l.speed||0,p=`left-scroll linear ${c}s infinite ${l.direction==="right"?"reverse":""}`),{"--text-scroll-width":`${s}px`,"--text-scroll-height":`${d}px`,animation:p}});return(s,d)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"scrollText",ref:i,class:e.normalizeClass(["f-scroll-text",`f-scroll-text--${l.type}`])},[e.createElementVNode("div",{ref_key:"textContent",ref:r,class:"text-content",style:e.normalizeStyle(e.unref(_))},[e.renderSlot(s.$slots,"default")],4)],2))}});E.install=function(t){t.component("FScrollText",E)};const L={class:"f-scroll-table__head"},R=["onClick"],A={key:1},k=e.defineComponent({__name:"index",props:{name:{default:""},data:{default:()=>[]},columns:{default:()=>[]},border:{type:Boolean,default:!0},stripe:{type:Boolean,default:!0},wrap:{type:Boolean,default:!0},align:{default:"center"},cellStyle:null,maxHeight:{default:"auto"},mode:{default:"single"},pageSize:{default:5},togglePage:{default:1},toggleDur:{default:5*1e3},emptyEmitDur:{default:10*1e3},emitCondition:{default:2},pageAnimateDur:{default:300},mouseEvent:{type:Boolean,default:!0}},emits:["handle-toggle","cell-click"],setup(t,{expose:l}){const i=t,r=e.reactive({tableData:[],currData:[],pageData:[],currPage:1,toggleCount:0,intervalId:null,setTimeoutId:null,isStopToggle:!1,isEmpty:!1}),_=e.getCurrentInstance(),s=e.ref(),{deepCloneArr:d,setCurrData:m,setPageInterval:x,setEmptyTimeout:o,clearTimer:c,setPage:p}=$(r,i,_),{handleCellClick:a}=D(_),{getRowClass:n,getCellClass:g,getTableStyle:y,getBodyStyle:w,getRowStyle:q,getExtraCellStyle:z,getCellStyle:H}=I(r,i),N=f=>{f.style.opacity="0",f.style.gridTemplateRows="0fr"},F=(f,T)=>{f.offsetWidth,f.style.opacity="1",f.style.gridTemplateRows="1fr",T()},W=async f=>{f.style.opacity="1"},M=async(f,T)=>{f.style.opacity="0",f.style.gridTemplateRows="0fr",await new Promise(u=>{setTimeout(()=>{f.remove(),u(!0)},i.pageAnimateDur)}),T()};return e.watch(()=>i.data,f=>{r.tableData=d(f),m()},{immediate:!0,deep:!0}),e.onMounted(()=>{i.mouseEvent&&(s.value.addEventListener("mouseenter",()=>{c(!0,!0),r.isStopToggle=!0}),s.value.addEventListener("mouseleave",()=>{r.isStopToggle=!1,r.tableData.length?x():o()}))}),e.onBeforeUnmount(()=>{c()}),l({setPage:p}),(f,T)=>(e.openBlock(),e.createElementBlock("div",{ref:"scrollTable",class:e.normalizeClass(["f-scroll-table",{"is-border":i.border}]),style:e.normalizeStyle(e.unref(y)(i.columns))},[e.createElementVNode("div",L,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.columns,(u,C)=>(e.openBlock(),e.createElementBlock("div",{class:"f-scroll-table__cell",style:e.normalizeStyle(e.unref(z)(u)),key:C},e.toDisplayString(u.label),5))),128))]),e.createElementVNode("div",{ref_key:"scrollTable__body",ref:s,class:"f-scroll-table__content is-hidden-scrollbar",style:e.normalizeStyle(e.unref(w))},[e.createVNode(e.TransitionGroup,{tag:"div",css:!1,onBeforeEnter:N,onEnter:F,onBeforeLeave:W,onLeave:M},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.currData,(u,C)=>(e.openBlock(),e.createElementBlock("div",{class:"f-scroll-table__row-wrap",key:u},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(n)(u,C))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.columns,(h,B)=>(e.openBlock(),e.createElementBlock("div",{class:"f-scroll-table__cell",style:e.normalizeStyle([e.unref(z)(h),e.unref(H)(u,h.type==="index"?"_index_":h.prop,C,B)]),key:`${u[h.prop]}${B}`,onClick:O=>e.unref(a)(O,u,u[h.prop],C,B)},[h.type==="index"?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(e.unref(g))},e.toDisplayString(u._index_||""),3)):h.type==="scroll"?(e.openBlock(),e.createElementBlock("div",A,[e.createVNode(e.unref(E),e.normalizeProps(e.guardReactiveProps(h.scrollOption)),{default:e.withCtx(()=>[e.createElementVNode("div",null,e.toDisplayString(u[h.prop]),1)]),_:2},1040)])):h.slot?(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(e.unref(g))},[e.renderSlot(f.$slots,h.slot,{params:{row:u,column:h.prop,$index:C}})],2)):(e.openBlock(),e.createElementBlock("div",{key:3,class:e.normalizeClass(e.unref(g))},e.toDisplayString(u[h.prop]),3))],12,R))),128))],2)]))),128))]),_:3})],4)],6))}}),U="";k.install=function(t){t.component("FScrollTable",k)};const V={title:"scrollTable 轮播表格",name:"scrollTable",category:"数据展示",status:"100%",install(t){t.use(k)}};S.ScrollTable=k,S.default=V,Object.defineProperties(S,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
