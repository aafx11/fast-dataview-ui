(function(x,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(x=typeof globalThis<"u"?globalThis:x||self,e(x.index=x.index||{},x.Vue))})(this,function(x,e){"use strict";function D(t){return{handleToggle:r=>{t.emit("handle-toggle",r)},handleCellClick:(r,_,s,d,m)=>{t.emit("cell-click",_,s,d,m,r)}}}const z=t=>Array.isArray(t)&&t||[],b=(t,l=new WeakMap)=>{if(t===null)return t;if(t instanceof Date)return new Date(t);if(t instanceof RegExp)return new RegExp(t);if(typeof t!="object")return t;if(l.get(t))return l.get(t);let a=new t.constructor;l.set(t,a);for(let r in t)t.hasOwnProperty(r)&&(a[r]=b(t[r],l));return a};function $(t,l,a){const{handleToggle:r}=D(a),_=o=>{let n=z(o);return b(n)},s=()=>{t.toggleCount+=1,t.toggleCount>=l.emitCondition&&r(l.name)},d=async(o,n,u)=>{let y=u;n.map(w=>w._index_=++y),t.currData.length?o===l.pageSize?t.currData=[...n]:(t.currData.push(...n),t.currData.splice(0,o)):t.currData.push(...n)},m=async()=>{if(t.tableData.length){c(!1,!0),t.isEmpty=!1;let o;l.mode==="single"?o=l.togglePage:o=l.pageSize;let n,u;t.currPage===1?(n=0,u=l.pageSize):(n=o*(t.currPage-2)+l.pageSize,u=o*(t.currPage-1)+l.pageSize);let y=t.tableData.slice(n,u);y.length?t.currPage===1&&t.toggleCount===0?d(l.pageSize,y,n):t.currPage===1?await d(l.pageSize,y,n):await d(o,y,n):(t.currPage=1,s(),m()),S()}else c(),t.currPage=1,t.currData=[],t.isEmpty=!0,i()},S=()=>{t.intervalId===null&&!t.isStopToggle&&(t.intervalId=setInterval(()=>{t.currPage+=1,m()},l.toggleDur))},i=()=>{t.setTimeoutId===null&&(t.setTimeoutId=setTimeout(()=>{r(l.name)},l.emptyEmitDur))},c=(o=!0,n=!0)=>{t.intervalId&&o&&(clearInterval(t.intervalId),t.intervalId=null),t.setTimeoutId&&n&&(clearTimeout(t.setTimeoutId),t.setTimeoutId=null)};return{deepCloneArr:_,setCurrData:m,setPageInterval:S,setEmptyTimeout:i,clearTimer:c,setPage:(o=1)=>{c(),t.currPage=o;let n;l.mode==="single"?n=l.togglePage:n=l.pageSize;let u=n*(t.currPage-1),y=n*(t.currPage-1)+l.pageSize,w=t.tableData.slice(u,y);w.length?(d(l.pageSize,w,u),S()):m(),t.tableData.length||i()}}}function I(t,l){const a=e.computed(()=>function(i,c){const p=["f-scroll-table__row"];return l.stripe&&c%2===1&&p.push("f-scroll-table_row--striped"),p}),r=e.computed(()=>{const i=["cell"];return l.wrap?i.push("cell--wrap"):i.push("cell--nowrap"),i}),_=e.computed(()=>function(i){let c=i.reduce((p,o)=>p+=o.width,0);return{width:`${c}px`,"max-width":`${c}px`}}),s=e.computed(()=>({height:l.maxHeight||"auto","max-height":l.maxHeight||"auto","--page-animate-dur":`${l.pageAnimateDur}ms`})),d=e.computed(()=>function(i){return{}}),m=e.computed(()=>function(i){return{width:`${i.width}px`,"max-width":`${i.width}px`,"text-align":i.align||l.align||"start"}}),S=e.computed(()=>function(i,c,p,o){return typeof l.cellStyle=="function"?l.cellStyle.call(null,{rowIndex:p,columnIndex:o,row:i,column:c}):l.cellStyle||{}});return{getRowClass:a,getCellClass:r,getTableStyle:_,getBodyStyle:s,getRowStyle:d,getExtraCellStyle:m,getCellStyle:S}}const E=e.defineComponent({__name:"index",props:{type:{default:"default"},direction:{default:"left"},speed:{default:60},mode:{default:"infinite"}},setup(t){const l=t,a=e.ref(),r=e.ref(),_=e.computed(()=>{var o,n,u,y;let s=((o=a.value)==null?void 0:o.offsetWidth)||0,d=((n=a.value)==null?void 0:n.offsetHeight)||0,m=((u=r.value)==null?void 0:u.offsetWidth)||0,S=((y=r.value)==null?void 0:y.offsetHeight)||0;if(l.mode==="overflow"&&(["up","down"].includes(l.direction)&&S<d||["left","right"].includes(l.direction)&&m<s))return{"--text-scroll-width":`${s}px`,"--text-scroll-height":`${d}px`,animation:""};let i,c,p;return["up","down"].includes(l.direction)&&(i=d+S,c=i/l.speed||0,p=`up-scroll linear ${c}s infinite ${l.direction==="down"?"reverse":""}`),["left","right"].includes(l.direction)&&(i=s+m,c=i/l.speed||0,p=`left-scroll linear ${c}s infinite ${l.direction==="right"?"reverse":""}`),{"--text-scroll-width":`${s}px`,"--text-scroll-height":`${d}px`,animation:p}});return(s,d)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"scrollText",ref:a,class:e.normalizeClass(["f-scroll-text",`f-scroll-text--${l.type}`])},[e.createElementVNode("div",{ref_key:"textContent",ref:r,class:"text-content",style:e.normalizeStyle(e.unref(_))},[e.renderSlot(s.$slots,"default")],4)],2))}});E.install=function(t){t.component("FScrollText",E)};const N={class:"f-scroll-table__head"},A=["onClick"],L={key:1},k=e.defineComponent({__name:"index",props:{name:{type:String,default:""},data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},border:{type:Boolean,default:!0},stripe:{type:Boolean,default:!0},wrap:{type:Boolean,default:!0},align:{type:String,default:"center"},cellStyle:{type:[Object,Function],default:()=>{}},maxHeight:{type:String,default:"auto"},mode:{type:String,default:"single"},pageSize:{type:Number,default:5},togglePage:{type:Number,default:1},toggleDur:{type:Number,default:5*1e3},emptyEmitDur:{type:Number,default:5*1e3},emitCondition:{type:Number,default:2},pageAnimateDur:{type:Number,default:300},mouseEvent:{type:Boolean,default:!0}},emits:["handle-toggle","cell-click"],setup(t,{expose:l}){const a=t,r=e.reactive({tableData:[],currData:[],pageData:[],currPage:1,toggleCount:0,intervalId:null,setTimeoutId:null,isStopToggle:!1,isEmpty:!1}),_=e.getCurrentInstance(),s=e.ref(),{deepCloneArr:d,setCurrData:m,setPageInterval:S,setEmptyTimeout:i,clearTimer:c,setPage:p}=$(r,a,_),{handleCellClick:o}=D(_),{getRowClass:n,getCellClass:u,getTableStyle:y,getBodyStyle:w,getRowStyle:q,getExtraCellStyle:P,getCellStyle:V}=I(r,a),H=f=>{f.style.opacity="0",f.style.gridTemplateRows="0fr"},F=(f,T)=>{f.offsetWidth,f.style.opacity="1",f.style.gridTemplateRows="1fr",T()},O=async f=>{f.style.opacity="1"},W=async(f,T)=>{f.style.opacity="0",f.style.gridTemplateRows="0fr",await new Promise(g=>{setTimeout(()=>{f.remove(),g(!0)},a.pageAnimateDur)}),T()};return e.watch(()=>a.data,f=>{r.tableData=d(f),m()},{immediate:!0,deep:!0}),e.onMounted(()=>{a.mouseEvent&&(s.value.addEventListener("mouseenter",()=>{c(!0,!0),r.isStopToggle=!0}),s.value.addEventListener("mouseleave",()=>{r.isStopToggle=!1,r.tableData.length?S():i()}))}),e.onBeforeUnmount(()=>{c()}),l({setPage:p}),(f,T)=>(e.openBlock(),e.createElementBlock("div",{ref:"scrollTable",class:e.normalizeClass(["f-scroll-table",{"is-border":a.border}]),style:e.normalizeStyle(e.unref(y)(a.columns))},[e.createElementVNode("div",N,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.columns,(g,C)=>(e.openBlock(),e.createElementBlock("div",{class:"f-scroll-table__cell",style:e.normalizeStyle(e.unref(P)(g)),key:C},e.toDisplayString(g.label),5))),128))]),e.createElementVNode("div",{ref_key:"scrollTable__body",ref:s,class:"f-scroll-table__content is-hidden-scrollbar",style:e.normalizeStyle(e.unref(w))},[e.createVNode(e.TransitionGroup,{tag:"div",css:!1,onBeforeEnter:H,onEnter:F,onBeforeLeave:O,onLeave:W},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.currData,(g,C)=>(e.openBlock(),e.createElementBlock("div",{class:"f-scroll-table__row-wrap",key:g},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(n)(g,C))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.columns,(h,B)=>(e.openBlock(),e.createElementBlock("div",{class:"f-scroll-table__cell",style:e.normalizeStyle([e.unref(P)(h),e.unref(V)(g,h.type==="index"?"_index_":h.prop,C,B)]),key:`${g[h.prop]}${B}`,onClick:M=>e.unref(o)(M,g,g[h.prop],C,B)},[h.type==="index"?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(e.unref(u))},e.toDisplayString(g._index_||""),3)):h.type==="scroll"?(e.openBlock(),e.createElementBlock("div",L,[e.createVNode(e.unref(E),e.normalizeProps(e.guardReactiveProps(h.scrollOption)),{default:e.withCtx(()=>[e.createElementVNode("div",null,e.toDisplayString(g[h.prop]),1)]),_:2},1040)])):h.slot?(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(e.unref(u))},[e.renderSlot(f.$slots,h.slot,{params:{row:g,column:h.prop,$index:C}})],2)):(e.openBlock(),e.createElementBlock("div",{key:3,class:e.normalizeClass(e.unref(u))},e.toDisplayString(g[h.prop]),3))],12,A))),128))],2)]))),128))]),_:3})],4)],6))}}),U="";k.install=function(t){t.component("FScrollTable",k)};const R={title:"scrollTable 轮播表格",name:"scrollTable",category:"数据展示",status:"100%",install(t){t.use(k)}};x.ScrollTable=k,x.default=R,Object.defineProperties(x,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
