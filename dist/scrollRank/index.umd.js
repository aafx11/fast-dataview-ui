(function(i,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(i=typeof globalThis<"u"?globalThis:i||self,e(i.index=i.index||{},i.Vue))})(this,function(i,e){"use strict";const w=Object.assign,B=t=>Array.isArray(t)&&t.length,E=t=>Array.isArray(t)&&t||[],N=(t,r,s="reverse")=>t.sort(P(r,s)),P=(t,r="reverse")=>function(s,n){return s[t]<n[t]?r==="normal"?-1:1:s[t]>n[t]?r==="normal"?1:-1:0},k=(t,r=new WeakMap)=>{if(t===null)return t;if(t instanceof Date)return new Date(t);if(t instanceof RegExp)return new RegExp(t);if(typeof t!="object")return t;if(r.get(t))return r.get(t);let s=new t.constructor;r.set(t,s);for(let n in t)t.hasOwnProperty(n)&&(s[n]=k(t[n],r));return s},V=e.defineComponent({name:"FProgress",props:{percent:{type:Number,default:0},color:{type:Array,default:()=>[]},duration:{type:Number,default:.5}},setup(t,{slots:r}){const s=["#d1d5db","#3b82f6","white"];let n=e.computed(()=>B(t.color)?w(s,t.color):s);return{getProgressStyle:e.computed(()=>({"--bgc":n.value[0],"--progress-color":n.value[1],"--progress-text-color":n.value[2],"--duration":`${t.duration}s`}))}}}),x=(t,r)=>{const s=t.__vccOpts||t;for(const[n,u]of r)s[n]=u;return s};function L(t,r,s,n,u,g){return e.openBlock(),e.createElementBlock("div",{class:"f-progress",style:e.normalizeStyle(t.getProgressStyle)},[e.createElementVNode("div",{class:"progress-inner",style:e.normalizeStyle({width:`${t.percent}%`})},[e.renderSlot(t.$slots,"default",{percent:t.percent},()=>[e.createElementVNode("span",null,e.toDisplayString(t.percent?`${t.percent}%`:""),1)])],4)],4)}const p=x(V,[["render",L]]);p.install=function(t){t.component(p.name,p)};const R={class:"f-scroll-rank"},$={class:"f-scroll-rank__item-wrap"},D={class:"f-scroll-rank__item-info"},C={key:0,class:"f-scroll-rank__item-rank"},z={class:"f-scroll-rank__item-name"},A={class:"f-scroll-rank__item-info-right"},F={key:0,class:"f-scroll-rank__item-percent"},T={key:1,class:"f-scroll-rank__item-ratio"},I={key:2,class:"f-scroll-rank__item-format"},M={class:"f-scroll-rank__item-progress"},m=e.defineComponent({__name:"index",props:{data:{type:Array,default:()=>[]},pageSize:{type:Number,default:5},togglePage:{type:Number,default:3},toggleDur:{type:Number,default:3*1e3},toggleDuration:{type:Number,default:300},maxValue:{type:Number},valueFormatter:{type:Function},order:{type:String,default:"reverse"},showRank:{type:Boolean,default:!0},showPercent:{type:Boolean,default:!0},showRatio:{type:Boolean,default:!0},color:{type:Array,default:()=>["#24293e","#024be4"]},progressDuration:{type:Number,default:.5}},setup(t){const r=t,s=e.ref();let n=e.reactive({dataList:[],currList:[],currPage:1,isEmpty:!1,intervalId:null});const u=o=>{let a=k(E(o)),l=[];r.order==="default"?l=a:l=N(a,"value",r.order),typeof r.valueFormatter=="function"&&(l=l.map((c,d)=>{var f;return c.formattedValue=(f=r.valueFormatter)==null?void 0:f.call(null,{name:c.name,value:c.value,maxValue:_.value,index:d}),c})),n.dataList=l},g=async(o,a,l)=>{let c=l;a.map(d=>d._index_=++c),n.currList.length?o===r.pageSize?n.currList=[...a]:(n.currList.push(...a),n.currList.splice(0,o)):n.currList.push(...a),e.nextTick(()=>{s.value&&(s.value.style.maxHeight=`${s.value.getBoundingClientRect().height}px`,s.value.style.height=`${s.value.getBoundingClientRect().height}px`)})},y=async()=>{if(n.dataList.length){n.isEmpty=!1;let o;r.togglePage>=r.pageSize?o=r.pageSize:o=r.togglePage;let a,l;n.currPage===1?(a=0,l=r.pageSize):(a=o*(n.currPage-2)+r.pageSize,l=o*(n.currPage-1)+r.pageSize);let c=n.dataList.slice(a,l);c.length?n.currPage===1?await g(r.pageSize,c,a):await g(o,c,a):(n.currPage=1,y()),b()}else h(),n.isEmpty=!0,n.currPage=1,n.currList=[]},b=()=>{n.intervalId===null&&(n.intervalId=setInterval(()=>{n.currPage+=1,y()},r.toggleDur))},h=()=>{n.intervalId&&(clearInterval(n.intervalId),n.intervalId=null)},_=e.computed(()=>{var o,a;return r.maxValue?r.maxValue:r.order==="normal"?((o=n.currList.at(-1))==null?void 0:o.value)||0:((a=n.currList[0])==null?void 0:a.value)||0}),S=e.computed(()=>function(o){let a,l=_.value;a=o/l;const c=(d,f)=>Math.round(d*Math.pow(10,f))/Math.pow(10,f);return typeof a=="number"?c(a*100,1):0}),W=o=>{o.style.opacity="0",o.style.gridTemplateRows="0fr"},q=(o,a)=>{o.offsetWidth,o.style.opacity="1",o.style.gridTemplateRows="1fr",a()},G=async o=>{o.style.opacity="1",o.style.margin="0"},H=async(o,a)=>{o.style.opacity="0",o.style.margin="0",o.style.gridTemplateRows="0fr",await new Promise(l=>{setTimeout(()=>{o.remove(),l(!0)},r.toggleDuration)}),a()};return e.onBeforeUnmount(()=>{h()}),e.watch(()=>r.data,o=>{u(o),y()},{deep:!0,immediate:!0}),(o,a)=>(e.openBlock(),e.createElementBlock("div",R,[e.createElementVNode("div",{class:"f-scroll-rank__list",ref_key:"scrollRank",ref:s,style:e.normalizeStyle({"--page-animate-dur":`${r.toggleDuration}ms`})},[e.createVNode(e.TransitionGroup,{tag:"div",css:!1,onBeforeEnter:W,onEnter:q,onBeforeLeave:G,onLeave:H},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n).currList,(l,c)=>(e.openBlock(),e.createElementBlock("div",{class:"f-scroll-rank__item",key:l},[e.createElementVNode("div",$,[e.createElementVNode("div",D,[r.showRank?(e.openBlock(),e.createElementBlock("span",C,e.toDisplayString(`NO.${l._index_}`),1)):e.createCommentVNode("v-if",!0),e.createElementVNode("span",z,e.toDisplayString(l.name||""),1),e.createElementVNode("div",A,[r.showPercent?(e.openBlock(),e.createElementBlock("span",F,e.toDisplayString(`${e.unref(S)(l.value)}%`),1)):e.createCommentVNode("v-if",!0),r.showRatio&&typeof r.valueFormatter!="function"?(e.openBlock(),e.createElementBlock("span",T,e.toDisplayString(`${l.value} / ${e.unref(_)}`),1)):e.createCommentVNode("v-if",!0),typeof r.valueFormatter=="function"?(e.openBlock(),e.createElementBlock("span",I,e.toDisplayString(`${l.formattedValue}`),1)):e.createCommentVNode("v-if",!0)])]),e.createElementVNode("div",M,[e.createVNode(e.unref(p),{percent:e.unref(S)(l.value),color:r.color,duration:r.progressDuration},null,8,["percent","color","duration"])])])]))),128))]),_:1})],4)]))}});m.install=function(t){t.component("FScrollRank",m)};const O={title:"scrollRank 轮播排名表格",name:"scrollRank",category:"数据展示",status:"100%",install(t){t.use(m)}};i.ScrollRank=m,i.default=O,Object.defineProperties(i,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
