(function(i,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(i=typeof globalThis<"u"?globalThis:i||self,e(i.index=i.index||{},i.Vue))})(this,function(i,e){"use strict";const h=Object.assign,S=t=>Array.isArray(t)&&t.length,w=t=>Array.isArray(t)&&t||[],E=(t,n,r="reverse")=>t.sort(N(n,r)),N=(t,n="reverse")=>function(r,s){return r[t]<s[t]?n==="normal"?-1:1:r[t]>s[t]?n==="normal"?1:-1:0},_=(t,n=new WeakMap)=>{if(t===null)return t;if(t instanceof Date)return new Date(t);if(t instanceof RegExp)return new RegExp(t);if(typeof t!="object")return t;if(n.get(t))return n.get(t);let r=new t.constructor;n.set(t,r);for(let s in t)t.hasOwnProperty(s)&&(r[s]=_(t[s],n));return r},P=e.defineComponent({name:"FProgress",props:{percent:{type:Number,default:0},color:{type:Array,default:()=>[]},duration:{type:Number,default:.5}},setup(t,{slots:n}){const r=["#d1d5db","#3b82f6","white"];let s=e.computed(()=>S(t.color)?h(r,t.color):r);return{getProgressStyle:e.computed(()=>({"--bgc":s.value[0],"--progress-color":s.value[1],"--progress-text-color":s.value[2],"--duration":`${t.duration}s`}))}}}),V=(t,n)=>{const r=t.__vccOpts||t;for(const[s,u]of n)r[s]=u;return r};function B(t,n,r,s,u,g){return e.openBlock(),e.createElementBlock("div",{class:"f-progress",style:e.normalizeStyle(t.getProgressStyle)},[e.createElementVNode("div",{class:"progress-inner",style:e.normalizeStyle({width:`${t.percent}%`})},[e.renderSlot(t.$slots,"default",{percent:t.percent},()=>[e.createElementVNode("span",null,e.toDisplayString(t.percent?`${t.percent}%`:""),1)])],4)],4)}const f=V(P,[["render",B]]);f.install=function(t){t.component(f.name,f)};const L={class:"f-scroll-rank"},x={class:"f-scroll-rank__item-wrap"},D={class:"f-scroll-rank__item-info"},$={key:0,class:"f-scroll-rank__item-rank"},R={class:"f-scroll-rank__item-name"},z={class:"f-scroll-rank__item-info-right"},A={key:0,class:"f-scroll-rank__item-percent"},C={key:1,class:"f-scroll-rank__item-ratio"},F={key:2,class:"f-scroll-rank__item-format"},I={class:"f-scroll-rank__item-progress"},m=e.defineComponent({__name:"index",props:{data:{type:Array,default:()=>[]},pageSize:{type:Number,default:5},togglePage:{type:Number,default:3},toggleDur:{type:Number,default:3*1e3},toggleDuration:{type:Number,default:500},maxValue:{type:Number},valueFormatter:{type:Function},order:{type:String,default:"reverse"},showRank:{type:Boolean,default:!0},showPercent:{type:Boolean,default:!0},showRatio:{type:Boolean,default:!0},color:{type:Array,default:()=>["#24293e","#024be4"]},progressDuration:{type:Number,default:.5}},setup(t){const n=t;let r=e.reactive({dataList:[],currList:[],currPage:1,isEmpty:!1,intervalId:null});const s=o=>{let a=_(w(o)),l=[];n.order==="default"?l=a:l=E(a,"value",n.order),typeof n.valueFormatter=="function"&&(l=l.map((c,d)=>{var p;return c.formattedValue=(p=n.valueFormatter)==null?void 0:p.call(null,{name:c.name,value:c.value,maxValue:y.value,index:d}),c})),r.dataList=l},u=async(o,a,l)=>{let c=l;a.map(d=>d._index_=++c),r.currList.length?o===n.pageSize?r.currList=[...a]:(r.currList.push(...a),r.currList.splice(0,o)):r.currList.push(...a)},g=async()=>{if(r.dataList.length){r.isEmpty=!1;let o;n.togglePage>=n.pageSize?o=n.pageSize:o=n.togglePage;let a,l;r.currPage===1?(a=0,l=n.pageSize):(a=o*(r.currPage-2)+n.pageSize,l=o*(r.currPage-1)+n.pageSize);let c=r.dataList.slice(a,l);c.length?r.currPage===1?await u(n.pageSize,c,a):await u(o,c,a):(r.currPage=1,g()),M()}else O(),r.isEmpty=!0,r.currPage=1,r.currList=[]},M=()=>{r.intervalId===null&&(r.intervalId=setInterval(()=>{r.currPage+=1,g()},n.toggleDur))},O=()=>{r.intervalId&&(clearInterval(r.intervalId),r.intervalId=null)},y=e.computed(()=>{var o,a;return n.maxValue?n.maxValue:n.order==="normal"?((o=r.currList.at(-1))==null?void 0:o.value)||0:((a=r.currList[0])==null?void 0:a.value)||0}),k=e.computed(()=>function(o){let a,l=y.value;a=o/l;const c=(d,p)=>Math.round(d*Math.pow(10,p))/Math.pow(10,p);return typeof a=="number"?c(a*100,1):0}),b=o=>{o.style.opacity="0",o.style.gridTemplateRows="0fr"},W=(o,a)=>{o.offsetWidth,o.style.opacity="1",o.style.gridTemplateRows="1fr",a()},q=async o=>{o.style.opacity="1"},G=async(o,a)=>{o.style.opacity="0",o.style.margin="0",o.style.gridTemplateRows="0fr",await new Promise(l=>{setTimeout(()=>{o.remove(),l(!0)},n.toggleDuration)}),a()};return e.watch(()=>n.data,o=>{s(o),g()},{deep:!0,immediate:!0}),(o,a)=>(e.openBlock(),e.createElementBlock("div",L,[e.createElementVNode("div",{class:"f-scroll-rank__list",style:e.normalizeStyle({"--page-animate-dur":`${n.toggleDuration}ms`})},[e.createVNode(e.TransitionGroup,{tag:"div",css:!1,onBeforeEnter:b,onEnter:W,onBeforeLeave:q,onLeave:G},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r).currList,(l,c)=>(e.openBlock(),e.createElementBlock("div",{class:"f-scroll-rank__item",key:l},[e.createElementVNode("div",x,[e.createElementVNode("div",D,[n.showRank?(e.openBlock(),e.createElementBlock("span",$,e.toDisplayString(`NO.${l._index_}`),1)):e.createCommentVNode("v-if",!0),e.createElementVNode("span",R,e.toDisplayString(l.name||""),1),e.createElementVNode("div",z,[n.showPercent?(e.openBlock(),e.createElementBlock("span",A,e.toDisplayString(`${e.unref(k)(l.value)}%`),1)):e.createCommentVNode("v-if",!0),n.showRatio&&typeof n.valueFormatter!="function"?(e.openBlock(),e.createElementBlock("span",C,e.toDisplayString(`${l.value} / ${e.unref(y)}`),1)):e.createCommentVNode("v-if",!0),typeof n.valueFormatter=="function"?(e.openBlock(),e.createElementBlock("span",F,e.toDisplayString(`${l.formattedValue}`),1)):e.createCommentVNode("v-if",!0)])]),e.createElementVNode("div",I,[e.createVNode(e.unref(f),{percent:e.unref(k)(l.value),color:n.color,duration:n.progressDuration},null,8,["percent","color","duration"])])])]))),128))]),_:1})],4)]))}});m.install=function(t){t.component("FScrollRank",m)};const T={title:"scrollRank 轮播排名表格",name:"scrollRank",category:"数据展示",status:"100%",install(t){t.use(m)}};i.ScrollRank=m,i.default=T,Object.defineProperties(i,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
