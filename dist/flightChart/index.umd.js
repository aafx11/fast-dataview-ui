(function(w,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(w=typeof globalThis<"u"?globalThis:w||self,e(w.index=w.index||{},w.Vue))})(this,function(w,e){"use strict";const V=Object.assign,D=t=>Array.isArray(t)&&t||[],$=(t,i=new WeakMap)=>{if(t===null)return t;if(t instanceof Date)return new Date(t);if(t instanceof RegExp)return new RegExp(t);if(typeof t!="object")return t;if(i.get(t))return i.get(t);let r=new t.constructor;i.set(t,r);for(let a in t)t.hasOwnProperty(a)&&(r[a]=$(t[a],i));return r},W=(t,i)=>{const r=Math.abs(t[0]-i[0]),a=Math.abs(t[1]-i[1]);return Math.sqrt(r*r+a*a)};function Z(t,i){const r=window.MutationObserver,a=new r(i);return a.observe(t,{attributes:!0,attributeFilter:["style"],attributeOldValue:!0}),a}var G;const H=typeof window<"u",j=t=>typeof t=="string",A=()=>{};H&&((G=window==null?void 0:window.navigator)!=null&&G.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function M(t){return typeof t=="function"?t():e.unref(t)}function v(t,i){function r(...a){return new Promise((u,d)=>{Promise.resolve(t(()=>i.apply(this,a),{fn:i,thisArg:this,args:a})).then(u).catch(d)})}return r}function ee(t,i={}){let r,a,u=A;const d=k=>{clearTimeout(k),u(),u=A};return k=>{const g=M(t),h=M(i.maxWait);return r&&d(r),g<=0||h!==void 0&&h<=0?(a&&(d(a),a=null),Promise.resolve(k())):new Promise((l,s)=>{u=i.rejectOnCancel?s:l,h&&!a&&(a=setTimeout(()=>{r&&d(r),a=null,l(k())},h)),r=setTimeout(()=>{a&&d(a),a=null,l(k())},g)})}}function te(t){return t}function ne(t){return e.getCurrentScope()?(e.onScopeDispose(t),!0):!1}function re(t,i=200,r={}){return v(ee(i,r),t)}function oe(t){var i;const r=M(t);return(i=r==null?void 0:r.$el)!=null?i:r}const ie=H?window:void 0;function le(...t){let i,r,a,u;if(j(t[0])||Array.isArray(t[0])?([r,a,u]=t,i=ie):[i,r,a,u]=t,!i)return A;Array.isArray(r)||(r=[r]),Array.isArray(a)||(a=[a]);const d=[],y=()=>{d.forEach(l=>l()),d.length=0},k=(l,s,x,p)=>(l.addEventListener(s,x,p),()=>l.removeEventListener(s,x,p)),g=e.watch(()=>[oe(i),M(u)],([l,s])=>{y(),l&&d.push(...r.flatMap(x=>a.map(p=>k(l,x,p,s))))},{immediate:!0,flush:"post"}),h=()=>{g(),y()};return ne(h),h}const U=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},q="__vueuse_ssr_handlers__";U[q]=U[q]||{};var K;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(K||(K={}));var ae=Object.defineProperty,X=Object.getOwnPropertySymbols,se=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable,Y=(t,i,r)=>i in t?ae(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r,ue=(t,i)=>{for(var r in i||(i={}))se.call(i,r)&&Y(t,r,i[r]);if(X)for(var r of X(i))ce.call(i,r)&&Y(t,r,i[r]);return t};ue({linear:te},{easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]});const de=(t,i,r,a)=>{const u=e.ref(0),d=e.ref(0),y=e.ref(0),k=e.ref(0);let g,h=null,l=null;const s=(Q=!0)=>new Promise(R=>{e.nextTick(()=>{l=t.value,u.value=t.value?t.value.clientWidth:0,d.value=t.value?t.value.clientHeight:0,y.value=l?l.getBoundingClientRect().width:0,k.value=l?l.getBoundingClientRect().height:0,t.value?(!u.value||!d.value)&&console.warn("Component width or height is 0px"):console.warn("Failed to get dom node"),typeof i=="function"&&Q&&i(),R(!0)})}),x=()=>{h=Z(l,g),le(window,"resize",g)},p=()=>{h&&(h.disconnect(),h.takeRecords(),h=null)},N=async()=>{await s(!1),g=re(s,300),x(),typeof r=="function"&&r()};return e.onMounted(()=>{N()}),e.onUnmounted(()=>{p()}),{width:u,height:d,afterWidth:y,afterHeight:k,initWH:s}},fe={width:"100%",height:"100%"},he=e.createStaticVNode('<defs><radialGradient id="lineGradient" cx="50%" cy="50%" r="50%"><stop offset="0%" stop-color="#fff" stop-opacity="1"></stop><stop offset="100%" stop-color="#fff" stop-opacity="0"></stop></radialGradient><radialGradient id="haloGradient" cx="50%" cy="50%" r="50%"><stop offset="0%" stop-color="#fff" stop-opacity="0"></stop><stop offset="100%" stop-color="#fff" stop-opacity="1"></stop></radialGradient></defs>',1),me=["id","cx","cy"],ye=["values","dur"],ke=["dur"],ge=["id"],pe=["xlink:href"],_e=["xlink:href","fill","mask"],we=["fill","x","y"],xe=["href","width","height","x","y"],$e=["id","d"],Ee=["id"],Oe=["r"],Ce=["dur","path"],Be=["xlink:href","stroke-width","stroke"],be=["xlink:href","stroke-width","stroke","mask"],Ne=["from","to","dur"],Pe={key:2},L=e.defineComponent({__name:"index",props:{bgUrl:{type:String},points:{type:Array,default:()=>[]},paths:{type:Array,default:()=>[]},line:{type:Object,default:()=>({show:!0,type:"line",width:2,color:"#0080ff",orbitColor:"rgba(103, 224, 227, .2)",duration:2e3,radius:100,k:-.5,curvature:5})},halo:{type:Object,default:()=>({show:!0,duration:2e3,color:"#3891c2",radius:100})},title:{type:Object,default:()=>({show:!0,offest:[0,-10],color:"black",fontSize:16})},icon:{type:Object,default:()=>({show:!0,url:"",width:10,height:10})}},emits:["chart-click"],setup(t,{expose:i}){const r=t,a=e.ref();let u;e.onMounted(()=>{u=e.getCurrentInstance()});const d=e.reactive({halo:{show:!0,duration:2e3,color:"#3891c2",radius:100},title:{show:!0,offest:[0,-10],color:"black",fontSize:16},icon:{show:!0,url:"",width:10,height:10},line:{show:!0,width:3,color:"#ffde93",orbitColor:"rgba(103, 224, 227, .2)",duration:700,radius:100,k:-.5,curvature:5}}),y=e.reactive({points:[],paths:[]}),k=o=>{let{offsetX:f,offsetY:n}=o;const _=(f/l.value).toFixed(2),c=(n/s.value).toFixed(2);u==null||u.emit("chart-click",_,c,o)},g=()=>{p(),N()},h=()=>{p(),N()},{width:l,height:s,initWH:x}=de(a,g,h);i({resize:x});const p=()=>{let o=$(D(r.points));y.points=o.map((f,n)=>({...f,halo:V({},d.halo,$(r.halo),f.halo),title:V({},d.title,$(r.title),f.title),icon:V({},d.icon,$(r.icon),f.icon),key:`${f.coordinate.toString()}${n}`}))},N=()=>{let o=$(D(r.paths));y.paths=o.map((f,n)=>{var F,E;let{source:_,route:c,target:P,line:T}=f,O=V({},d.line,$(r.line),T),C=(F=y.points.find(({name:m})=>m===_))==null?void 0:F.coordinate,B=(E=y.points.find(({name:m})=>m===P))==null?void 0:E.coordinate,b=c?[C,...c,B]:[C,B];b=b.filter(m=>m!==void 0);let S=[];for(let m=0;m<b.length-1;m++){let Me=b[m],I=Q(Me,b[m+1],O.k,O.curvature),Le=`M${I[0].toString()} Q${I[1].toString()} ${I[2].toString()}`,Te=`${I.toString()}`;S.push({path:I,d:Le,key:Te})}return{...f,line:O,routeList:S}})},Q=(o,f,n,_)=>{let[c,P]=o,[T,O]=f;const[C,B]=[(c+T)/2,(P+O)/2];let S=W([c,P],[T,O])/_,F=S/2,[E,m]=[C,B];do E+=F,m=R(n,[C,B],E)[1];while(W([C,B],[E,m])<S);return[o,[E,m],f]};function R(o,[f,n],_){const c=n-o*f+o*_;return[_,c]}let J=e.computed(()=>function(o){return`M${o[0][0]*l.value},${o[0][1]*s.value} 
    Q${o[1][0]*l.value},${o[1][1]*s.value} 
    ${o[2][0]*l.value},${o[2][1]*s.value}`}),Ie=e.computed(()=>function(o){return`M${o[0][0]*l.value},${o[0][1]*s.value} 
    Q${o[1][0]*l.value},${o[1][1]*s.value} 
    ${o[2][0]*l.value},${o[2][1]*s.value}`}),Ve=e.computed(()=>function(o){return{x1:o[0][0]*l.value,y1:o[0][1]*s.value,x2:o[1][0]*l.value,y2:o[1][1]*s.value,x3:o[2][0]*l.value,y3:o[2][1]*s.value}});e.computed(()=>function(o){return`"M${o[0][0]*l.value},${o[0][1]*s.value} Q${o[1][0]*l.value},${o[1][1]*s.value} ${o[2][0]*l.value},${o[2][1]*s.value}"`});let z=e.computed(()=>function(o){return u?u.proxy.$refs[o][0].getTotalLength():0});return e.watch(()=>r,o=>{p(),N()},{deep:!0,immediate:!0}),(o,f)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"flightChart",ref:a,class:"f-flight-chart"},[e.createElementVNode("div",{class:"f-flight-chart__wrap",style:e.normalizeStyle(`background-image: url(${r.bgUrl})`),onClick:k},[(e.openBlock(),e.createElementBlock("svg",fe,[he,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.points,(n,_)=>(e.openBlock(),e.createElementBlock("g",{key:n.key},[e.createElementVNode("defs",null,[n.halo.show?(e.openBlock(),e.createElementBlock("circle",{key:0,id:`halo${n.key}`,cx:n.coordinate[0]*e.unref(l),cy:n.coordinate[1]*e.unref(s)},[e.createElementVNode("animate",{attributeName:"r",values:`1;${n.halo.radius}`,dur:`${n.halo.duration}ms`,repeatCount:"indefinite"},null,8,ye),e.createElementVNode("animate",{attributeName:"opacity",values:"1;0",dur:`${n.halo.duration}ms`,repeatCount:"indefinite"},null,8,ke)],8,me)):e.createCommentVNode("v-if",!0),e.createElementVNode("mask",{id:`mask${n.key}`},[e.createElementVNode("use",{"xlink:href":`#halo${n.key}`,fill:"url(#haloGradient)"},null,8,pe)],8,ge)]),n.halo.show?(e.openBlock(),e.createElementBlock("use",{key:0,"xlink:href":`#halo${n.key}`,fill:n.halo.color,mask:`url(#mask${n.key})`},null,8,_e)):e.createCommentVNode("v-if",!0),n.title.show?(e.openBlock(),e.createElementBlock("text",{key:1,class:"point__title",style:e.normalizeStyle({fontSize:`${n.title.fontSize}px`}),fill:n.title.color,x:n.coordinate[0]*e.unref(l)+n.title.offest[0],y:n.coordinate[1]*e.unref(s)+n.title.offest[1]},e.toDisplayString(n.name),13,we)):e.createCommentVNode("v-if",!0),n.icon.show?(e.openBlock(),e.createElementBlock("image",{key:2,class:"point__icon",href:n.icon.url,width:n.icon.width,height:n.icon.height,x:n.coordinate[0]*e.unref(l)-n.icon.width/2,y:n.coordinate[1]*e.unref(s)-n.icon.height/2},null,8,xe)):e.createCommentVNode("v-if",!0)]))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.paths,(n,_)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.routeList,(c,P)=>(e.openBlock(),e.createElementBlock("g",null,[e.createElementVNode("defs",null,[e.createElementVNode("path",{id:c.key,ref_for:!0,ref:c.key,d:e.unref(J)(c.path),fill:"transparent",style:{overflow:"hidden"}},null,8,$e),n.line.show&&!n.line.slot?(e.openBlock(),e.createElementBlock("mask",{key:0,id:`mask${c.key}`},[e.createElementVNode("circle",{cx:"0",cy:"0",r:n.line.radius,fill:"url(#lineGradient)"},[e.createElementVNode("animateMotion",{dur:`${n.line.duration}ms`,path:e.unref(J)(c.path),rotate:"auto",repeatCount:"indefinite"},null,8,Ce)],8,Oe)],8,Ee)):e.createCommentVNode("v-if",!0)]),n.line.show?(e.openBlock(),e.createElementBlock("use",{key:0,"xlink:href":`#${c.key}`,"stroke-width":n.line.width,stroke:n.line.orbitColor},null,8,Be)):e.createCommentVNode("v-if",!0),n.line.show&&!n.line.slot?(e.openBlock(),e.createElementBlock("use",{key:1,"xlink:href":`#${c.key}`,"stroke-width":n.line.width,stroke:n.line.color,mask:`url(#mask${c.key})`},[e.createElementVNode("animate",{attributeName:"stroke-dasharray",from:`0, ${e.unref(z)(c.key)}`,to:`${e.unref(z)(c.key)}, 0`,dur:`${n.line.duration}ms`,repeatCount:"indefinite"},null,8,Ne)],8,be)):e.createCommentVNode("v-if",!0),n.line.show&&n.line.slot?(e.openBlock(),e.createElementBlock("g",Pe,[e.renderSlot(o.$slots,n.line.slot,{path:e.unref(Ie)(c.path),pathArr:e.unref(Ve)(c.path),totalLength:e.unref(z)(c.key),line:n.line})])):e.createCommentVNode("v-if",!0)]))),256))],64))),256))]))],4)],512))}}),Ae="";L.install=function(t){t.component("FFlightChart",L)};const Se={title:"flightChart 飞线图",name:"flightChart",category:"图表",status:"100%",install(t){t.use(L)}};w.FlightChart=L,w.default=Se,Object.defineProperties(w,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
