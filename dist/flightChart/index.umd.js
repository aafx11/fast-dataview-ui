(function(p,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(p=typeof globalThis<"u"?globalThis:p||self,t(p.index=p.index||{},p.Vue))})(this,function(p,t){"use strict";const _=Object.assign,T=e=>Array.isArray(e)&&e||[],m=(e,n=new WeakMap)=>{if(e===null)return e;if(e instanceof Date)return new Date(e);if(e instanceof RegExp)return new RegExp(e);if(typeof e!="object")return e;if(n.get(e))return n.get(e);let r=new e.constructor;n.set(e,r);for(let o in e)e.hasOwnProperty(o)&&(r[o]=m(e[o],n));return r};function F(e,n){const r=window.MutationObserver,o=new r(n);return o.observe(e,{attributes:!0,attributeFilter:["style"],attributeOldValue:!0}),o}var E;const I=typeof window<"u",N=e=>typeof e=="string",O=()=>{};I&&((E=window==null?void 0:window.navigator)!=null&&E.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function k(e){return typeof e=="function"?e():t.unref(e)}function A(e,n){function r(...o){return new Promise((a,s)=>{Promise.resolve(e(()=>n.apply(this,o),{fn:n,thisArg:this,args:o})).then(a).catch(s)})}return r}function R(e,n={}){let r,o,a=O;const s=h=>{clearTimeout(h),a(),a=O};return h=>{const d=k(e),c=k(n.maxWait);return r&&s(r),d<=0||c!==void 0&&c<=0?(o&&(s(o),o=null),Promise.resolve(h())):new Promise((l,u)=>{a=n.rejectOnCancel?u:l,c&&!o&&(o=setTimeout(()=>{r&&s(r),o=null,l(h())},c)),r=setTimeout(()=>{o&&s(o),o=null,l(h())},d)})}}function W(e){return e}function z(e){return t.getCurrentScope()?(t.onScopeDispose(e),!0):!1}function V(e,n=200,r={}){return A(R(n,r),e)}function D(e){var n;const r=k(e);return(n=r==null?void 0:r.$el)!=null?n:r}const Q=I?window:void 0;function L(...e){let n,r,o,a;if(N(e[0])||Array.isArray(e[0])?([r,o,a]=e,n=Q):[n,r,o,a]=e,!n)return O;Array.isArray(r)||(r=[r]),Array.isArray(o)||(o=[o]);const s=[],y=()=>{s.forEach(l=>l()),s.length=0},h=(l,u,f)=>(l.addEventListener(u,f,a),()=>l.removeEventListener(u,f,a)),d=t.watch(()=>D(n),l=>{y(),l&&s.push(...r.flatMap(u=>o.map(f=>h(l,u,f))))},{immediate:!0,flush:"post"}),c=()=>{d(),y()};return z(c),c}const x=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},b="__vueuse_ssr_handlers__";x[b]=x[b]||{},x[b];var B;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(B||(B={}));var M=Object.defineProperty,P=Object.getOwnPropertySymbols,H=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,S=(e,n,r)=>n in e?M(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,U=(e,n)=>{for(var r in n||(n={}))H.call(n,r)&&S(e,r,n[r]);if(P)for(var r of P(n))$.call(n,r)&&S(e,r,n[r]);return e};U({linear:W},{easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]});const G=(e,n,r,o)=>{const a=t.ref(0),s=t.ref(0),y=t.ref(0),h=t.ref(0);let d,c=null,l=null;const u=(C=!0)=>new Promise(j=>{t.nextTick(()=>{l=e.value,a.value=e.value?e.value.clientWidth:0,s.value=e.value?e.value.clientHeight:0,y.value=l?l.getBoundingClientRect().width:0,h.value=l?l.getBoundingClientRect().height:0,e.value?(!a.value||!s.value)&&console.warn("Component width or height is 0px"):console.warn("Failed to get dom node"),typeof n=="function"&&C&&n(),j(!0)})}),f=()=>{c=F(l,d),L(window,"resize",d)},i=()=>{c&&(c.disconnect(),c.takeRecords(),c=null)},w=async()=>{await u(!1),d=V(u,200),f(),typeof r=="function"&&r()};return t.onMounted(()=>{w()}),t.onUnmounted(()=>{i()}),{width:a,height:s,afterWidth:y,afterHeight:h,initWH:u}},q={width:"100%",height:"100%"},v=["cx","cy"],K=["values","dur"],X=["fill"],Y=["fill","x","y"],J=["href","width","height","x","y"],g=t.defineComponent({name:"index",props:{bgUrl:{type:String},points:{type:Array,default:()=>[]},paths:{type:Array,default:()=>[]},line:{type:Object,default:()=>({show:!0,type:"line",width:1,color:"#ffde93",orbitColor:"rgba(103, 224, 227, .2)",duration:700,radius:100})},halo:{type:Object,default:()=>({show:!0,duration:700,color:"#3891c2",radius:100})},title:{type:Object,default:()=>({show:!0,offest:[0,0],color:"black",fontSize:16})},icon:{type:Object,default:()=>({show:!0,url:"",width:10,height:10})}},emits:["map-click"],setup(e){const n=e,r=t.ref(),o=t.getCurrentInstance(),a=t.reactive({halo:{show:!0,duration:700,color:"#3891c2",radius:100},title:{show:!0,offest:[0,0],color:"black",fontSize:16},icon:{show:!0,url:"",width:10,height:10}}),s=t.reactive({points:[]}),y=u=>{let{offsetX:f,offsetY:i}=u;const w=(f/d.value).toFixed(2),C=(i/c.value).toFixed(2);o==null||o.emit("map-click",w,C,u)},h=()=>{},{width:d,height:c}=G(r,h),l=()=>{let u=m(T(n.points));s.points=u.map((f,i)=>(console.log("icon",f.icon),{...f,halo:_({},a.halo,m(n.halo),f.halo),title:_({},a.title,m(n.title),f.title),icon:_({},a.icon,m(n.icon),f.icon),key:`${f.coordinate.toString()}${i}`})),console.log("points",s.points)};return t.watch(()=>n,u=>{l()},{deep:!0,immediate:!0}),(u,f)=>(t.openBlock(),t.createElementBlock("div",{ref_key:"flightChart",ref:r,class:"f-flight-chart"},[t.createElementVNode("div",{class:"f-flight-chart__wrap",style:t.normalizeStyle(`background-image: url(${n.bgUrl})`),onClick:y},[(t.openBlock(),t.createElementBlock("svg",q,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(s.points,(i,w)=>(t.openBlock(),t.createElementBlock("g",{key:i.key},[t.createElementVNode("defs",null,[i.halo.show?(t.openBlock(),t.createElementBlock("circle",{key:0,id:"halo",cx:i.coordinate[0]*t.unref(d),cy:i.coordinate[1]*t.unref(c)},[t.createElementVNode("animate",{"attribute-name":"r",values:`1;${i.halo.radius}`,dur:`${i.halo.duration}ms`,repeatCount:"indefinite"},null,8,K)],8,v)):t.createCommentVNode("",!0)]),i.halo.show?(t.openBlock(),t.createElementBlock("use",{key:0,"xlink:href":"#halo",fill:i.halo.color},null,8,X)):t.createCommentVNode("",!0),i.title.show?(t.openBlock(),t.createElementBlock("text",{key:1,style:t.normalizeStyle({fontSize:`${i.title.fontSize}px`}),fill:i.title.color,x:i.coordinate[0]*t.unref(d)+i.title.offest[0],y:i.coordinate[1]*t.unref(c)+i.title.offest[1]},t.toDisplayString(i.name),13,Y)):t.createCommentVNode("",!0),i.icon.show?(t.openBlock(),t.createElementBlock("image",{key:2,href:i.icon.url,width:i.icon.width,height:i.icon.height,x:i.coordinate[0]*t.unref(d),y:i.coordinate[1]*t.unref(c)},null,8,J)):t.createCommentVNode("",!0)]))),128))]))],4)],512))}});g.install=function(e){e.component("FFlightChart",g)};const Z={title:"FFlightChart 飞线图",category:"飞线图",status:"20%",install(e){e.use(g)}};p.FlightChart=g,p.default=Z,Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
