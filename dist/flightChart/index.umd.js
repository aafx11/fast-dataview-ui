(function(_,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(_=typeof globalThis<"u"?globalThis:_||self,e(_.index=_.index||{},_.Vue))})(this,function(_,e){"use strict";const S=Object.assign,G=t=>Array.isArray(t)&&t||[],x=(t,r=new WeakMap)=>{if(t===null)return t;if(t instanceof Date)return new Date(t);if(t instanceof RegExp)return new RegExp(t);if(typeof t!="object")return t;if(r.get(t))return r.get(t);let o=new t.constructor;r.set(t,o);for(let l in t)t.hasOwnProperty(l)&&(o[l]=x(t[l],r));return o},H=(t,r)=>{const o=Math.abs(t[0]-r[0]),l=Math.abs(t[1]-r[1]);return Math.sqrt(o*o+l*l)};function J(t,r){const o=window.MutationObserver,l=new o(r);return l.observe(t,{attributes:!0,attributeFilter:["style"],attributeOldValue:!0}),l}var U;const q=typeof window<"u",Z=t=>typeof t=="string",T=()=>{};q&&((U=window==null?void 0:window.navigator)!=null&&U.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function F(t){return typeof t=="function"?t():e.unref(t)}function j(t,r){function o(...l){return new Promise((d,u)=>{Promise.resolve(t(()=>r.apply(this,l),{fn:r,thisArg:this,args:l})).then(d).catch(u)})}return o}function v(t,r={}){let o,l,d=T;const u=y=>{clearTimeout(y),d(),d=T};return y=>{const k=F(t),s=F(r.maxWait);return o&&u(o),k<=0||s!==void 0&&s<=0?(l&&(u(l),l=null),Promise.resolve(y())):new Promise((a,h)=>{d=r.rejectOnCancel?h:a,s&&!l&&(l=setTimeout(()=>{o&&u(o),l=null,a(y())},s)),o=setTimeout(()=>{l&&u(l),l=null,a(y())},k)})}}function ee(t){return t}function te(t){return e.getCurrentScope()?(e.onScopeDispose(t),!0):!1}function ne(t,r=200,o={}){return j(v(r,o),t)}function re(t){var r;const o=F(t);return(r=o==null?void 0:o.$el)!=null?r:o}const oe=q?window:void 0;function ie(...t){let r,o,l,d;if(Z(t[0])||Array.isArray(t[0])?([o,l,d]=t,r=oe):[r,o,l,d]=t,!r)return T;Array.isArray(o)||(o=[o]),Array.isArray(l)||(l=[l]);const u=[],w=()=>{u.forEach(a=>a()),u.length=0},y=(a,h,g)=>(a.addEventListener(h,g,d),()=>a.removeEventListener(h,g,d)),k=e.watch(()=>re(r),a=>{w(),a&&u.push(...o.flatMap(h=>l.map(g=>y(a,h,g))))},{immediate:!0,flush:"post"}),s=()=>{k(),w()};return te(s),s}const A=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Q="__vueuse_ssr_handlers__";A[Q]=A[Q]||{},A[Q];var K;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(K||(K={}));var le=Object.defineProperty,X=Object.getOwnPropertySymbols,ae=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable,Y=(t,r,o)=>r in t?le(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,ce=(t,r)=>{for(var o in r||(r={}))ae.call(r,o)&&Y(t,o,r[o]);if(X)for(var o of X(r))se.call(r,o)&&Y(t,o,r[o]);return t};ce({linear:ee},{easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]});const ue=(t,r,o,l)=>{const d=e.ref(0),u=e.ref(0),w=e.ref(0),y=e.ref(0);let k,s=null,a=null;const h=(V=!0)=>new Promise(z=>{e.nextTick(()=>{a=t.value,d.value=t.value?t.value.clientWidth:0,u.value=t.value?t.value.clientHeight:0,w.value=a?a.getBoundingClientRect().width:0,y.value=a?a.getBoundingClientRect().height:0,t.value?(!d.value||!u.value)&&console.warn("Component width or height is 0px"):console.warn("Failed to get dom node"),typeof r=="function"&&V&&r(),z(!0)})}),g=()=>{s=J(a,k),ie(window,"resize",k)},R=()=>{s&&(s.disconnect(),s.takeRecords(),s=null)},D=async()=>{await h(!1),k=ne(h,200),g(),typeof o=="function"&&o()};return e.onMounted(()=>{D()}),e.onUnmounted(()=>{R()}),{width:d,height:u,afterWidth:w,afterHeight:y,initWH:h}},de={width:"100%",height:"100%"},fe=e.createStaticVNode('<defs><radialGradient id="lineGradient" cx="50%" cy="50%" r="50%"><stop offset="0%" stop-color="#fff" stop-opacity="1"></stop><stop offset="100%" stop-color="#fff" stop-opacity="0"></stop></radialGradient><radialGradient id="haloGradient" cx="50%" cy="50%" r="50%"><stop offset="0%" stop-color="#fff" stop-opacity="0"></stop><stop offset="100%" stop-color="#fff" stop-opacity="1"></stop></radialGradient></defs>',1),he=["id","cx","cy"],me=["values","dur"],ye=["dur"],ke=["id"],ge=["xlink:href"],pe=["xlink:href","fill","mask"],_e=["fill","x","y"],we=["href","width","height","x","y"],xe=["id","d"],$e=["id"],Ee=["r"],Oe=["dur","path"],Ce=["xlink:href","stroke-width","stroke"],Be=["xlink:href","stroke-width","stroke","mask"],be=["from","to","dur"],Ne={key:2},I=e.defineComponent({__name:"index",props:{bgUrl:{type:String},points:{type:Array,default:()=>[]},paths:{type:Array,default:()=>[]},line:{type:Object,default:()=>({show:!0,type:"line",width:2,color:"#0080ff",orbitColor:"rgba(103, 224, 227, .2)",duration:2e3,radius:100,k:-.5,curvature:5})},halo:{type:Object,default:()=>({show:!0,duration:2e3,color:"#3891c2",radius:100})},title:{type:Object,default:()=>({show:!0,offest:[0,-10],color:"black",fontSize:16})},icon:{type:Object,default:()=>({show:!0,url:"",width:10,height:10})}},emits:["chart-click"],setup(t){const r=t,o=e.ref();let l;e.onMounted(()=>{l=e.getCurrentInstance()});const d=e.reactive({halo:{show:!0,duration:2e3,color:"#3891c2",radius:100},title:{show:!0,offest:[0,-10],color:"black",fontSize:16},icon:{show:!0,url:"",width:10,height:10},line:{show:!0,width:3,color:"#ffde93",orbitColor:"rgba(103, 224, 227, .2)",duration:700,radius:100,k:-.5,curvature:5}}),u=e.reactive({points:[],paths:[]}),w=i=>{let{offsetX:f,offsetY:n}=i;const p=(f/s.value).toFixed(2),c=(n/a.value).toFixed(2);l==null||l.emit("chart-click",p,c,i)},y=()=>{h(),g()},k=()=>{h(),g()},{width:s,height:a}=ue(o,y,k),h=()=>{let i=x(G(r.points));u.points=i.map((f,n)=>({...f,halo:S({},d.halo,x(r.halo),f.halo),title:S({},d.title,x(r.title),f.title),icon:S({},d.icon,x(r.icon),f.icon),key:`${f.coordinate.toString()}${n}`}))},g=()=>{let i=x(G(r.paths));u.paths=i.map((f,n)=>{var L,$;let{source:p,route:c,target:b,line:M}=f,E=S({},d.line,x(r.line),M),O=(L=u.points.find(({name:m})=>m===p))==null?void 0:L.coordinate,C=($=u.points.find(({name:m})=>m===b))==null?void 0:$.coordinate,B=c?[O,...c,C]:[O,C];B=B.filter(m=>m!==void 0);let N=[];for(let m=0;m<B.length-1;m++){let Ie=B[m],P=R(Ie,B[m+1],E.k,E.curvature),Ve=`M${P[0].toString()} Q${P[1].toString()} ${P[2].toString()}`,Me=`${P.toString()}`;N.push({path:P,d:Ve,key:Me})}return{...f,line:E,routeList:N}})},R=(i,f,n,p)=>{let[c,b]=i,[M,E]=f;const[O,C]=[(c+M)/2,(b+E)/2];let N=H([c,b],[M,E])/p,L=N/2,[$,m]=[O,C];do $+=L,m=D(n,[O,C],$)[1];while(H([O,C],[$,m])<N);return[i,[$,m],f]};function D(i,[f,n],p){const c=n-i*f+i*p;return[p,c]}let V=e.computed(()=>function(i){return`M${i[0][0]*s.value},${i[0][1]*a.value} 
    Q${i[1][0]*s.value},${i[1][1]*a.value} 
    ${i[2][0]*s.value},${i[2][1]*a.value}`}),z=e.computed(()=>function(i){return`M${i[0][0]*s.value},${i[0][1]*a.value} 
    Q${i[1][0]*s.value},${i[1][1]*a.value} 
    ${i[2][0]*s.value},${i[2][1]*a.value}`}),Se=e.computed(()=>function(i){return{x1:i[0][0]*s.value,y1:i[0][1]*a.value,x2:i[1][0]*s.value,y2:i[1][1]*a.value,x3:i[2][0]*s.value,y3:i[2][1]*a.value}});e.computed(()=>function(i){return`"M${i[0][0]*s.value},${i[0][1]*a.value} Q${i[1][0]*s.value},${i[1][1]*a.value} ${i[2][0]*s.value},${i[2][1]*a.value}"`});let W=e.computed(()=>function(i){return l?l.proxy.$refs[i][0].getTotalLength():0});return e.watch(()=>r,i=>{h(),g()},{deep:!0,immediate:!0}),(i,f)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"flightChart",ref:o,class:"f-flight-chart"},[e.createElementVNode("div",{class:"f-flight-chart__wrap",style:e.normalizeStyle(`background-image: url(${r.bgUrl})`),onClick:w},[(e.openBlock(),e.createElementBlock("svg",de,[fe,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.points,(n,p)=>(e.openBlock(),e.createElementBlock("g",{key:n.key},[e.createElementVNode("defs",null,[n.halo.show?(e.openBlock(),e.createElementBlock("circle",{key:0,id:`halo${n.key}`,cx:n.coordinate[0]*e.unref(s),cy:n.coordinate[1]*e.unref(a)},[e.createElementVNode("animate",{attributeName:"r",values:`1;${n.halo.radius}`,dur:`${n.halo.duration}ms`,repeatCount:"indefinite"},null,8,me),e.createElementVNode("animate",{attributeName:"opacity",values:"1;0",dur:`${n.halo.duration}ms`,repeatCount:"indefinite"},null,8,ye)],8,he)):e.createCommentVNode("v-if",!0),e.createElementVNode("mask",{id:`mask${n.key}`},[e.createElementVNode("use",{"xlink:href":`#halo${n.key}`,fill:"url(#haloGradient)"},null,8,ge)],8,ke)]),n.halo.show?(e.openBlock(),e.createElementBlock("use",{key:0,"xlink:href":`#halo${n.key}`,fill:n.halo.color,mask:`url(#mask${n.key})`},null,8,pe)):e.createCommentVNode("v-if",!0),n.title.show?(e.openBlock(),e.createElementBlock("text",{key:1,class:"point__title",style:e.normalizeStyle({fontSize:`${n.title.fontSize}px`}),fill:n.title.color,x:n.coordinate[0]*e.unref(s)+n.title.offest[0],y:n.coordinate[1]*e.unref(a)+n.title.offest[1]},e.toDisplayString(n.name),13,_e)):e.createCommentVNode("v-if",!0),n.icon.show?(e.openBlock(),e.createElementBlock("image",{key:2,class:"point__icon",href:n.icon.url,width:n.icon.width,height:n.icon.height,x:n.coordinate[0]*e.unref(s)-n.icon.width/2,y:n.coordinate[1]*e.unref(a)-n.icon.height/2},null,8,we)):e.createCommentVNode("v-if",!0)]))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.paths,(n,p)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.routeList,(c,b)=>(e.openBlock(),e.createElementBlock("g",null,[e.createElementVNode("defs",null,[e.createElementVNode("path",{id:c.key,ref_for:!0,ref:c.key,d:e.unref(V)(c.path),fill:"transparent",style:{overflow:"hidden"}},null,8,xe),n.line.show&&!n.line.slot?(e.openBlock(),e.createElementBlock("mask",{key:0,id:`mask${c.key}`},[e.createElementVNode("circle",{cx:"0",cy:"0",r:n.line.radius,fill:"url(#lineGradient)"},[e.createElementVNode("animateMotion",{dur:`${n.line.duration}ms`,path:e.unref(V)(c.path),rotate:"auto",repeatCount:"indefinite"},null,8,Oe)],8,Ee)],8,$e)):e.createCommentVNode("v-if",!0)]),n.line.show?(e.openBlock(),e.createElementBlock("use",{key:0,"xlink:href":`#${c.key}`,"stroke-width":n.line.width,stroke:n.line.orbitColor},null,8,Ce)):e.createCommentVNode("v-if",!0),n.line.show&&!n.line.slot?(e.openBlock(),e.createElementBlock("use",{key:1,"xlink:href":`#${c.key}`,"stroke-width":n.line.width,stroke:n.line.color,mask:`url(#mask${c.key})`},[e.createElementVNode("animate",{attributeName:"stroke-dasharray",from:`0, ${e.unref(W)(c.key)}`,to:`${e.unref(W)(c.key)}, 0`,dur:`${n.line.duration}ms`,repeatCount:"indefinite"},null,8,be)],8,Be)):e.createCommentVNode("v-if",!0),n.line.show&&n.line.slot?(e.openBlock(),e.createElementBlock("g",Ne,[e.renderSlot(i.$slots,n.line.slot,{path:e.unref(z)(c.path),pathArr:e.unref(Se)(c.path),totalLength:e.unref(W)(c.key),line:n.line})])):e.createCommentVNode("v-if",!0)]))),256))],64))),256))]))],4)],512))}}),Te="";I.install=function(t){t.component("FFlightChart",I)};const Pe={title:"flightChart 飞线图",name:"flightChart",category:"图表",status:"100%",install(t){t.use(I)}};_.FlightChart=I,_.default=Pe,Object.defineProperties(_,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
